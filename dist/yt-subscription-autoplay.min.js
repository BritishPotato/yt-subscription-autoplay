!function(){"use strict";var a,b,c,d="https://www.youtube.com/iframe_api",e="https://www.youtube.com/user_watch?video_id=",f="body {margin: 0}iframe {display: none; margin: auto}table {border-collapse: collapse}tr {cursor: pointer}tr:nth-child(even) {background: #F3F3F3}tr:hover {background: #BBEDFB}.control-right {float: right; margin-left: 2px}.control-left {float: left; margin-right: 2px}.watched td:nth-child(2) {border-right: 6px solid #F6BDBC}.now-playing {background: #A7EF91!important}.player-full {position: fixed; top: 0; left: 0; right: 0; background: rgba(0, 0, 0, .5); padding: 4px}.playlist-full {width: 100%}#seekBar {display: block; width: 100%; margin: auto}#playButton {width: 45px}",g=null,h={},i={},j={unwatched:function(){var a=Object.keys(h),b=0;for(b;h[a[b]].watched;b++);return a[b]},inOrder:function(){var b=Object.keys(h),c=b.indexOf(a);return b[c+1]}},k=j.unwatched,l=function(){var a=window.location.pathname.split("/");return a[a.length-1]},m=function(a){var b=document.createElement("tr");b.id=a.videoId,b.onclick=function(){window.player.loadVideoById(a.videoId)},a.watched&&b.classList.add("watched");var c=document.createElement("td");b.appendChild(c),c.innerHTML=a.time;var d=document.createElement("td");return b.appendChild(d),d.innerHTML=a.title,b},n=function(){var a=function(a){var b=document.createElement("option");return b.text=a,b},b=document.createElement("div");b.id="controls";var c=document.createElement("input");i.toggleVideo={showVideo:!1},c.id="toggleVideo",c.type="button",c.classList.add("control-right"),c.value="Toggle video",c.onclick=function(){i.toggleVideo.showVideo=!i.toggleVideo.showVideo,window.player.getIframe().style.display=i.toggleVideo.showVideo?"block":"none"};var d=document.createElement("input");i.playButton={element:d,icons:{play:"►",pause:"▐ ▌"}},d.id="playButton",d.classList.add("control-left"),d.type="button",d.value=i.playButton.icons.play,d.onclick=function(){window.player.getPlayerState()===YT.PlayerState.PLAYING?window.player.pauseVideo():window.player.playVideo()};var e=document.createElement("input");e.id="likeButton",e.type="button",e.classList.add("control-right"),e.value="✩",e.onclick=function(){console.log("like")};var f=document.createElement("input");i.volumeBar={element:f},f.id="volumeBar",f.classList.add("control-left"),f.type="range",f.min=0,f.max=100,f.value=0,f.oninput=function(a){window.player.setVolume(a.target.value)};var g=document.createElement("input");i.seekBar={element:g,pressed:!1},g.id="seekBar",g.type="range",g.min=0,g.value=0,g.onchange=function(a){window.player.seekTo(a.target.value)},g.onmousedown=function(){i.seekBar.pressed=!0},g.onmouseup=function(){i.seekBar.pressed=!1};var h=document.createElement("select");h.classList.add("control-right"),h.onchange=function(a){var b=a.target.querySelector("option:checked").value;k=j[b]};var l=a("Unwatched");l.value="unwatched",h.appendChild(l);var m=a("In order");return m.value="inOrder",h.appendChild(m),b.appendChild(g),b.appendChild(d),b.appendChild(f),b.appendChild(e),b.appendChild(c),b.appendChild(h),b},o=function(a){var b=new DOMParser;return b.parseFromString(a,"text/html")},p=function(a,b,c){var d="undefined"==typeof c?!0:c,e=new XMLHttpRequest;e.onreadystatechange=function(){4!==e.readyState||200!==e.status&&204!==e.status||!b||b(d?JSON.parse(e.responseText):e.responseText)},e.open("GET",a,!0),e.send()},q=function(b){if(!b.watched){var c=e+b.videoId;p(c,function(){document.getElementById(a).classList.add("watched"),h[a].watched=!0},!1)}},r=function(a){for(var b=o(a.load_more_widget_html),d=b.querySelector(".load-more-button").dataset.uixLoadMoreHref,e=o(a.content_html),f=e.querySelectorAll(".yt-lockup-video"),g=0;g<f.length;g++){var i=f[g],j=i.dataset.contextItemId,k=i.querySelector(".yt-uix-tile-link").textContent,l=i.querySelector(".video-time").textContent,n=null!==i.querySelector(".watched");h[j]={title:k,time:l,watched:n,videoId:j}}var q=document.createElement("tbody"),s=c.querySelector("tbody");null===s?c.appendChild(q):c.replaceChild(q,s);for(var t in h)q.appendChild(m(h[t]));var u=document.createElement("tr");q.appendChild(u);var v=document.createElement("td");u.appendChild(v),v.colSpan="2",v.id="loadMore",v.innerHTML="Load More",v.onclick=function(){p(d,r)}};return function(){var e=document.createElement("html"),j=document.createElement("head");e.appendChild(j),b=document.createElement("body"),e.appendChild(b),document.replaceChild(e,document.documentElement);for(var m=setTimeout(null,0),o=0;m>o;o++)clearTimeout(o);var s=document.createElement("style");j.appendChild(s),s.innerHTML=f;var t=document.createElement("div");b.appendChild(t),t.id="player",t.classList.add("player-full");var u=document.createElement("div");t.appendChild(u),u.id="ytPlayer",t.appendChild(n()),c=document.createElement("table"),b.appendChild(c),c.id="playlist",c.classList.add("playlist-full"),c.style.marginTop=t.clientHeight+"px",p("/feed_ajax?action_load_collection_feed=1&collection_id="+l()+"&paging=0",r);var v=document.createElement("script");v.src=d,b.appendChild(v),window.onYouTubeIframeAPIReady=function(){window.player=new YT.Player("ytPlayer",{width:480,height:270,events:{onStateChange:function(b){var c=b.target,d=b.data;if(d===YT.PlayerState.PLAYING&&null===g){var e=c.getVideoData().video_id;e!==a&&(void 0!==a&&document.getElementById(a).classList.remove("now-playing"),a=e,document.getElementById(a).classList.add("now-playing"),q(h[a])),i.seekBar.element.max=window.player.getDuration(),i.playButton.element.value=i.playButton.icons.pause,g=setInterval(function(){i.seekBar.pressed||(i.seekBar.element.value=window.player.getCurrentTime())},500)}if(d===YT.PlayerState.PAUSED&&(clearInterval(g),g=null,i.playButton.element.value=i.playButton.icons.play),d===YT.PlayerState.UNSTARTED&&(clearInterval(g),i.seekBar.element.min=0,g=null,i.playButton.element.value=i.playButton.icons.play),d===YT.PlayerState.ENDED){var f=k();void 0!==f&&c.loadVideoById(f),i.playButton.element.value=i.playButton.icons.play}},onReady:function(){i.volumeBar.element.value=window.player.getVolume()}}})}}(),{getVideoList:function(){return h},getNowPlaying:function(){return h[a]}}}();