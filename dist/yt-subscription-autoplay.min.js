!function(){"use strict";var a,b,c,d="https://www.youtube.com/iframe_api",e="https://www.youtube.com/user_watch?video_id=",f="https://www.youtube.com/get_video_info?video_id=",g={NONE:2,DISLIKE:1,LIKE:0},h="body {margin: 0}iframe {display: none; margin: auto}table {border-collapse: collapse; width: 100%}tr {cursor: pointer; border-right: 6px solid #A7EF91}tr:nth-child(even) {background: #F3F3F3}tr:hover {background: #A7EF91}.control-right {float: right; margin-left: 2px}.control-left {float: left; margin-right: 2px}.watched {border-right: 6px solid #F9CD5D}.now-playing {background: #A7EF91!important}.player-full {position: fixed; top: 0; left: 0; right: 0; background: rgba(0, 0, 0, .5); padding: 4px}#seekBar {display: block; width: 100%; margin: auto}#playButton {width: 45px}",i=null,j={},k={},l={unwatched:function(){var a=Object.keys(j),b=0;for(b;j[a[b]].watched;b++);return a[b]},inOrder:function(){var b=Object.keys(j),c=b.indexOf(a);return b[c+1]}},m=l.unwatched,n=function(){var a=window.location.pathname.split("/");return a[a.length-1]},o=function(a,b){var c=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),d=new RegExp("[\\?&]"+c+"=([^&#]*)"),e=d.exec(b);return null===e?"":decodeURIComponent(e[1].replace(/\+/g," "))},p=function(){var b=f+a;t(b,function(a){var b=parseInt(o("sentiment",a));b===g.LIKE?(k.likeButton.element.value=k.likeButton.icons.full,k.likeButton.full=!0):(k.likeButton.element.value=k.likeButton.icons.empty,k.likeButton.full=!1)},!1)},q=function(a){var b=document.createElement("tr");b.id=a.videoId,b.onclick=function(){window.player.loadVideoById(a.videoId)},a.watched&&b.classList.add("watched");var c=document.createElement("td");b.appendChild(c),c.innerHTML=a.time;var d=document.createElement("td");return b.appendChild(d),d.innerHTML=a.title,b},r=function(){var a=function(a){var b=document.createElement("option");return b.text=a,b},b=document.createElement("div");b.id="controls";var c=document.createElement("input");k.toggleVideo={showVideo:!1},c.id="toggleVideo",c.type="button",c.classList.add("control-right"),c.value="Toggle video",c.onclick=function(){k.toggleVideo.showVideo=!k.toggleVideo.showVideo,window.player.getIframe().style.display=k.toggleVideo.showVideo?"block":"none"};var d=document.createElement("input");k.playButton={element:d,icons:{play:"►",pause:"▐ ▌"}},d.id="playButton",d.classList.add("control-left"),d.type="button",d.value=k.playButton.icons.play,d.onclick=function(){window.player.getPlayerState()===YT.PlayerState.PLAYING?window.player.pauseVideo():window.player.playVideo()};var e=document.createElement("input");k.likeButton={element:e,icons:{full:"★",empty:"✩"},full:!1},e.id="likeButton",e.type="button",e.classList.add("control-right"),e.value=k.likeButton.icons.empty,e.onclick=v;var f=document.createElement("input");k.volumeBar={element:f},f.id="volumeBar",f.classList.add("control-left"),f.type="range",f.min=0,f.max=100,f.value=0,f.oninput=function(a){window.player.setVolume(a.target.value)};var g=document.createElement("input");k.seekBar={element:g,pressed:!1},g.id="seekBar",g.type="range",g.min=0,g.value=0,g.onchange=function(a){window.player.seekTo(a.target.value)},g.onmousedown=function(){k.seekBar.pressed=!0},g.onmouseup=function(){k.seekBar.pressed=!1};var h=document.createElement("select");h.classList.add("control-right"),h.onchange=function(a){var b=a.target.querySelector("option:checked").value;m=l[b]};var i=a("Unwatched");i.value="unwatched",h.appendChild(i);var j=a("In order");return j.value="inOrder",h.appendChild(j),b.appendChild(g),b.appendChild(d),b.appendChild(f),b.appendChild(e),b.appendChild(c),b.appendChild(h),b},s=function(a){var b=new DOMParser;return b.parseFromString(a,"text/html")},t=function(a,b,c,d,e){var f="undefined"==typeof c?!0:c,g="undefined"==typeof d?!0:d,h=new XMLHttpRequest;h.onreadystatechange=function(){4!==h.readyState||200!==h.status&&204!==h.status||!b||b(f?JSON.parse(h.responseText):h.responseText)},g?(h.open("POST",a,!0),h.setRequestHeader("Content-type","application/x-www-form-urlencoded"),h.send(e)):(h.open("GET",a,!0),h.send())},u=function(b){if(!b.watched){var c=e+b.videoId;t(c,function(){document.getElementById(a).classList.add("watched"),j[a].watched=!0},!1)}},v=function(){if([YT.PlayerState.PLAYING,YT.PlayerState.PAUSED].indexOf(window.player.getPlayerState())>-1){var b=yt.getConfig("XSRF_TOKEN"),c=k.likeButton,d="screen=h%3D1080%26w%3D1920%26d%3D24&session_token="+encodeURIComponent(b);c.full?t("https://www.youtube.com/watch_actions_ajax?action_indifferent_video=1&video_id="+a,function(a){console.log(a),c.element.value=c.icons.empty,c.full=!1},!1,!0,d):t("https://www.youtube.com/watch_actions_ajax?action_like_video=1&video_id="+a,function(a){console.log(a),c.element.value=c.icons.full,c.full=!0},!1,!0,d)}},w=function(a){for(var b=s(a.load_more_widget_html),d=b.querySelector(".load-more-button").dataset.uixLoadMoreHref,e=s(a.content_html),f=e.querySelectorAll(".yt-lockup-video"),g=0;g<f.length;g++){var h=f[g],i=h.dataset.contextItemId,k=h.querySelector(".yt-uix-tile-link").textContent,l=h.querySelector(".video-time").textContent,m=null!==h.querySelector(".watched");j[i]={title:k,time:l,watched:m,videoId:i}}var n=document.createElement("tbody"),o=c.querySelector("tbody");null===o?c.appendChild(n):c.replaceChild(n,o);for(var p in j)n.appendChild(q(j[p]));var r=document.createElement("tr");n.appendChild(r);var u=document.createElement("td");r.appendChild(u),u.colSpan="2",u.id="loadMore",u.innerHTML="Load More",u.onclick=function(){t(d,w)}};return function(){var e=document.createElement("html"),f=document.createElement("head");e.appendChild(f),b=document.createElement("body"),e.appendChild(b),document.replaceChild(e,document.documentElement);for(var g=setTimeout(null,0),l=0;g>l;l++)clearTimeout(l);var o=document.createElement("style");f.appendChild(o),o.innerHTML=h;var q=document.createElement("div");b.appendChild(q),q.id="player",q.classList.add("player-full");var s=document.createElement("div");q.appendChild(s),s.id="ytPlayer",q.appendChild(r()),c=document.createElement("table"),b.appendChild(c),c.id="playlist",c.style.marginTop=q.clientHeight+"px",t("/feed_ajax?action_load_collection_feed=1&collection_id="+n()+"&paging=0",w);var v=document.createElement("script");v.src=d,b.appendChild(v),window.onYouTubeIframeAPIReady=function(){window.player=new YT.Player("ytPlayer",{width:480,height:270,events:{onStateChange:function(b){var c=b.target,d=b.data;if(d===YT.PlayerState.PLAYING&&null===i){var e=c.getVideoData().video_id;e!==a&&(void 0!==a&&document.getElementById(a).classList.remove("now-playing"),a=e,document.getElementById(a).classList.add("now-playing"),u(j[a])),k.seekBar.element.max=window.player.getDuration(),k.playButton.element.value=k.playButton.icons.pause,i=setInterval(function(){k.seekBar.pressed||(k.seekBar.element.value=window.player.getCurrentTime())},500),p()}if(d===YT.PlayerState.PAUSED&&(clearInterval(i),i=null,k.playButton.element.value=k.playButton.icons.play),d===YT.PlayerState.UNSTARTED&&(clearInterval(i),k.seekBar.element.min=0,i=null,k.playButton.element.value=k.playButton.icons.play),d===YT.PlayerState.ENDED){var f=m();void 0!==f&&c.loadVideoById(f),k.playButton.element.value=k.playButton.icons.play}},onReady:function(){k.volumeBar.element.value=window.player.getVolume()}}})}}(),{getControls:function(){return k}}}();