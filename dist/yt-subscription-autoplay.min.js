!function(){"use strict";var a,b,c,d="https://www.youtube.com/iframe_api",e="https://www.youtube.com/user_watch?video_id=",f="body {margin: 0}table {border-collapse: collapse}tr {cursor: pointer}tr:hover {background: #BBEDFB}.watched td:nth-child(2) {border-right: 6px solid #F6BDBC}.now-playing {background: #A7EF91}#player {position: fixed}#playlist {float: right}",g={},h=function(){var a=window.location.pathname.split("/");return a[a.length-1]},i=function(a){var b=document.createElement("tr");b.id=a.videoId,b.onclick=function(){window.player.loadVideoById(a.videoId)},a.watched&&b.classList.add("watched");var c=document.createElement("td");b.appendChild(c),c.innerHTML=a.time;var d=document.createElement("td");return b.appendChild(d),d.innerHTML=a.title,b},j=function(a){var b=new DOMParser;return b.parseFromString(a,"text/html")},k=function(a,b,c){var d="undefined"==typeof c?!0:c,e=new XMLHttpRequest;e.onreadystatechange=function(){4!==e.readyState||200!==e.status&&204!==e.status||!b||b(d?JSON.parse(e.responseText):e.responseText)},e.open("GET",a,!0),e.send()},l=function(b){if(!b.watched){var c=e+b.videoId;k(c,function(){document.getElementById(a).classList.add("watched"),g[a].watched=!0},!1)}},m=function(a){for(var b=j(a.load_more_widget_html),d=b.querySelector(".load-more-button").dataset.uixLoadMoreHref,e=j(a.content_html),f=e.querySelectorAll(".yt-lockup-video"),h=0;h<f.length;h++){var l=f[h],n=l.dataset.contextItemId,o=l.querySelector(".yt-uix-tile-link").textContent,p=l.querySelector(".video-time").textContent,q=null!==l.querySelector(".watched");g[n]={title:o,time:p,watched:q,videoId:n}}var r=document.createElement("tbody"),s=c.querySelector("tbody");null===s?c.appendChild(r):c.replaceChild(r,s);for(var t in g)r.appendChild(i(g[t]));var u=document.createElement("tr");r.appendChild(u);var v=document.createElement("td");u.appendChild(v),v.colSpan="2",v.id="loadMore",v.innerHTML="Load More",v.onclick=function(){k(d,m)}};return function(){var e=document.createElement("html"),i=document.createElement("head");e.appendChild(i),b=document.createElement("body"),e.appendChild(b),document.replaceChild(e,document.documentElement);for(var j=setTimeout(null,0),n=0;j>n;n++)clearTimeout(n);var o=document.createElement("style");i.appendChild(o),o.innerHTML=f;var p=document.createElement("div");b.appendChild(p),p.id="player",c=document.createElement("table"),b.appendChild(c),c.id="playlist",k("/feed_ajax?action_load_collection_feed=1&collection_id="+h()+"&paging=0",m);var q=document.createElement("script");q.src=d,b.appendChild(q),window.onYouTubeIframeAPIReady=function(){window.player=new YT.Player("player",{width:480,height:270,iv_load_policy:3,events:{onStateChange:function(b){var c=b.target,d=b.data;if(d===YT.PlayerState.PLAYING){var e=c.getVideoData().video_id;e!==a&&(void 0!==a&&document.getElementById(a).classList.remove("now-playing"),a=e,document.getElementById(a).classList.add("now-playing"),l(g[a]))}if(d===YT.PlayerState.ENDED){var f,h=Object.keys(g),i=0;for(i;g[h[i]].watched;i++);f=g[i],void 0!==f&&c.loadVideoById(f)}}}})}}(),{getVideoList:function(){return g},getNowPlaying:function(){return g[a]}}}();